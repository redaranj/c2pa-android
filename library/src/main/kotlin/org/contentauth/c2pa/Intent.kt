/*
This file is licensed to you under the Apache License, Version 2.0
(http://www.apache.org/licenses/LICENSE-2.0) or the MIT license
(http://opensource.org/licenses/MIT), at your option.

Unless required by applicable law or agreed to in writing, this software is
distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS OF
ANY KIND, either express or implied. See the LICENSE-MIT and LICENSE-APACHE
files for the specific language governing permissions and limitations under
each license.
*/

package org.contentauth.c2pa

/**
 * Specifies what kind of manifest to create when building a C2PA claim.
 *
 * The builder intent determines how the manifest is structured and what assertions are
 * automatically added.
 *
 * @see Builder.setIntent
 */
sealed class BuilderIntent {
    /**
     * A new digital creation with the specified digital source type.
     *
     * Use this intent for assets that are being created for the first time, such as a freshly
     * captured photo or a newly generated image.
     *
     * The manifest must not have a parent ingredient. A `c2pa.created` action will be added if not
     * provided.
     *
     * @property digitalSourceType The type of digital source used to create this asset
     */
    data class Create(val digitalSourceType: DigitalSourceType) : BuilderIntent()

    /**
     * An edit of a pre-existing parent asset.
     *
     * Use this intent when modifying an existing asset, such as cropping a photo or applying
     * filters to an image.
     *
     * The manifest must have a parent ingredient. A parent ingredient will be generated from the
     * source stream if not otherwise provided. A `c2pa.opened` action will be tied to the parent
     * ingredient.
     */
    data object Edit : BuilderIntent()

    /**
     * A restricted version of edit for non-editorial changes.
     *
     * Use this intent for metadata-only updates that don't modify the hashed content of the asset,
     * such as updating EXIF data or adding descriptions.
     *
     * There must be only one ingredient, as a parent. No changes can be made to the hashed content
     * of the parent.
     */
    data object Update : BuilderIntent()

    internal fun toNativeIntent(): Int =
        when (this) {
            is Create -> 0 // Create
            is Edit -> 1 // Edit
            is Update -> 2 // Update
        }

    internal fun toNativeDigitalSourceType(): Int =
        when (this) {
            is Create -> digitalSourceType.toNativeType()
            else -> 0 // Empty
        }
}

/**
 * Defines the digital source type for content created by the builder.
 *
 * Digital source types classify how the original content was generated, which is important for
 * provenance and authenticity claims.
 *
 * @see BuilderIntent.Create
 */
enum class DigitalSourceType {
    /** No digital source type specified */
    EMPTY,

    /** Content generated from trained algorithmic data */
    TRAINED_ALGORITHMIC_DATA,

    /** Content captured directly from a digital camera or sensor */
    DIGITAL_CAPTURE,

    /** Content processed through computational photography */
    COMPUTATIONAL_CAPTURE,

    /** Content scanned from negative film */
    NEGATIVE_FILM,

    /** Content scanned from positive film */
    POSITIVE_FILM,

    /** Content scanned from a physical print */
    PRINT,

    /** Content that has been edited by humans */
    HUMAN_EDITS,

    /** Composite content with trained algorithmic media */
    COMPOSITE_WITH_TRAINED_ALGORITHMIC_MEDIA,

    /** Content enhanced by algorithms */
    ALGORITHMICALLY_ENHANCED,

    /** Content created digitally from scratch */
    DIGITAL_CREATION,

    /** Content generated from data */
    DATA_DRIVEN_MEDIA,

    /** Content generated by trained AI/ML models */
    TRAINED_ALGORITHMIC_MEDIA,

    /** Content generated by algorithms */
    ALGORITHMIC_MEDIA,

    /** Content captured from a screen */
    SCREEN_CAPTURE,

    /** Content captured in a virtual environment */
    VIRTUAL_RECORDING,

    /** Composite of multiple sources */
    COMPOSITE,

    /** Composite primarily from captured content */
    COMPOSITE_CAPTURE,

    /** Composite primarily from synthetic content */
    COMPOSITE_SYNTHETIC;

    internal fun toNativeType(): Int =
        when (this) {
            EMPTY -> 0
            TRAINED_ALGORITHMIC_DATA -> 1
            DIGITAL_CAPTURE -> 2
            COMPUTATIONAL_CAPTURE -> 3
            NEGATIVE_FILM -> 4
            POSITIVE_FILM -> 5
            PRINT -> 6
            HUMAN_EDITS -> 7
            COMPOSITE_WITH_TRAINED_ALGORITHMIC_MEDIA -> 8
            ALGORITHMICALLY_ENHANCED -> 9
            DIGITAL_CREATION -> 10
            DATA_DRIVEN_MEDIA -> 11
            TRAINED_ALGORITHMIC_MEDIA -> 12
            ALGORITHMIC_MEDIA -> 13
            SCREEN_CAPTURE -> 14
            VIRTUAL_RECORDING -> 15
            COMPOSITE -> 16
            COMPOSITE_CAPTURE -> 17
            COMPOSITE_SYNTHETIC -> 18
        }
}
